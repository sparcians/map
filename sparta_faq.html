<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The Sparta Modeling Framework: Sparta FAQ</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">The Sparta Modeling Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('sparta_faq.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Sparta FAQ</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#modeling_determinism">Modeling Determinism</a>
  </li>
  <li class="level1">
    <a href="#des_debugging">DES Debugging Techniques</a>
    <ul>
      <li class="level2 empty">
        <ul>
          <li class="level3">
            <a href="#autotoc_md13">Understanding/Looking at the Directed Acyclic Graph (DAG)</a>
          </li>
          <li class="level3">
            <a href="#autotoc_md14">Dumping Out Scheduler Information</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="modeling_determinism"></a>
Modeling Determinism</h1>
<ol type="1">
<li>Is determinism a good thing or bad thing in DES based models?</li>
<li>How do we ensure determinism in DES when we need it?</li>
<li>If there is a component with multiple events E1, E2, E3 which hasnâ€™t been explicitly ordered, how does Sparta schedule them? Is this schedule deterministic within the run and across runs?</li>
</ol>
<p>Sparta contains a Discrete Event Simulation (DES) engine. This means that a modeler is allowed to schedule events, or work, only when there's work to do. This naturally allows for faster simulation times and "fast forwarding" of simulation, skipping time when there's nothing for the scheduler to do.</p>
<p>Unfortunately, in most other DES-based simulation engines, a level of indeterminism is introduced due to random scheduling of events into the simulation kernel, especially if a developer introduces a timing or functional change.</p>
<p>As a pure C++ development platform, Sparta does not suffer from indeterminism <em>between one simulation run and another</em>. All events in a Sparta-based model are registered during construction time. Sparta will then map out those events with dependencies (either explicit or implicit) in a Directed Acyclic Graph (DAG). Those dependencies are established using precedence rules (see <a class="el" href="precedence_rules.html">Precedence operators for EventNode/Scheduleables</a>).</p>
<p>Those events that do not have any explicit dependencies are "free
form," but deterministic as long as the modeler does not introduce random behaviors during a running simulation: i.e. each run of the <em>same</em> workload will be exactly the <em>same</em> with the <em>same</em> parameters.</p>
<p>However, those "free form" events have the potential to be scheduled in a different order <em>between</em> different workloads or with <em>different</em> simulation parameters. This is mostly harmless, but can cause headache especially if the modeler assumes one event will be fired before another. To avoid that, the suggestion to the modeler is to provide a clean, clear design of their model and to draw ordering lines between items of work and establish precedence between Events. This will ensure determinism in the DES.</p>
<h1><a class="anchor" id="des_debugging"></a>
DES Debugging Techniques</h1>
<p>Debugging a DES based model has challenges. Some known problems to solve:</p><ol type="1">
<li>The frameworks says I have a DAG cycle &ndash; what is it and how do I debug this?</li>
<li>Why <em>was</em> a particular event scheduled?</li>
<li>Why <em>wasn't</em> a particular event scheduled?</li>
<li>Who scheduled that event?</li>
<li>Why does one event happen before the other?</li>
<li>Can I get a dependency graph of events?</li>
</ol>
<h3><a class="anchor" id="autotoc_md13"></a>
Understanding/Looking at the Directed Acyclic Graph (DAG)</h3>
<p>First, if you are using <a class="el" href="classsparta_1_1app_1_1CommandLineSimulator.html" title="Command line simulator front-end class with argument parsing Works in conjunction with sparta::app::S...">sparta::app::CommandLineSimulator</a> class, you can always dump the internal DAG that defines the given relationships between <a class="el" href="classsparta_1_1Scheduleable.html" title="A class that defines the basic scheduling interface to the Scheduler. Not intended to be used by mode...">sparta::Scheduleable</a> objects:</p>
<div class="fragment"><div class="line">./sparta_core_example --show-dag --no-run</div>
</div><!-- fragment --><p>Take an example from the DAG output and analyze it:</p>
<div class="fragment"><div class="line">V[in_uop_queue_credits&lt;DataInPort&gt;[Decode::receiveUopQueueCredits_(uint32_t)]]: id: 22, marker=white, edges(in=2, out=2), group: 17</div>
<div class="line">      -&gt; GOP[Tick]: id: 5, marker=white, edges(in=38, out=2), group: 21</div>
<div class="line">      -&gt; V[decode_insts_event[Decode::decodeInsts_()]]: id: 24, marker=white, edges(in=3, out=3), group: 18</div>
</div><!-- fragment --><p>This ordering is an implicit ordering between functions within the Decode block, specifically the receiving of uop credits from Rename (not listed) on a <a class="el" href="classsparta_1_1DataInPort.html" title="DataInPort receives data from sender using a DataOutPort.">sparta::DataInPort</a> (named <code>receiveUopQueueCredits</code>) and decoding of instructions (named <code>decodeInsts_</code>). (See <a class="el" href="core_example.html">Core Example Using Sparta</a>).</p>
<p>The <code>V</code> symbol represents a vertex in the DAG, which is one <a class="el" href="classsparta_1_1Scheduleable.html" title="A class that defines the basic scheduling interface to the Scheduler. Not intended to be used by mode...">sparta::Scheduleable</a>. This <a class="el" href="classsparta_1_1Scheduleable.html" title="A class that defines the basic scheduling interface to the Scheduler. Not intended to be used by mode...">sparta::Scheduleable</a> is a <a class="el" href="classsparta_1_1PayloadEvent.html" title="Class to schedule a Scheduleable in the future with a payload, typed on both the data type and the sc...">sparta::PayloadEvent</a> inside the <a class="el" href="classsparta_1_1DataInPort.html" title="DataInPort receives data from sender using a DataOutPort.">sparta::DataInPort</a> named <code>in_uop_queue_credits&lt;DataInPort&gt;[Decode::receiveUopQueueCredits_(uint32_t)]</code>. Specifically, this internal <a class="el" href="classsparta_1_1PayloadEvent.html" title="Class to schedule a Scheduleable in the future with a payload, typed on both the data type and the sc...">sparta::PayloadEvent</a> that will call the method <code>Decode::receiveUopQueueCredits_(uint32_t)</code> when data is to be delivered from the port.</p>
<p>This vertex has 2 edges in and 2 edges out. Those edges going out are listed, one being a GOP or <a class="el" href="classsparta_1_1GlobalOrderingPoint.html" title="Used to set precedence between Scheduleable types across simulation.">sparta::GlobalOrderingPoint</a> and the other is a registered triggered event that is designated to be scheduled after receiving of Uop Queue credits.</p>
<p>If the modeler introduces DAG cycle, the framework with throw and exception and generate <code>dag_cycle.dot</code> file. Using Graphviz tools (or the like), the modeler can visualize the DAG cycle graphically. Some common ways to solve cycles:</p>
<ol type="1">
<li>Within a unit/block: introduce an order between the events using the precedence rules (see <a class="el" href="precedence_rules.html">Precedence operators for EventNode/Scheduleables</a>)</li>
<li>Between blocks (different <a class="el" href="classsparta_1_1Unit.html" title="The is the base class for user defined blocks in simulation.">sparta::Unit</a> or <a class="el" href="classsparta_1_1Resource.html" title="The is the base class for all types of resources used by the SPARTA framework.">sparta::Resource</a>), use a <a class="el" href="classsparta_1_1GlobalOrderingPoint.html" title="Used to set precedence between Scheduleable types across simulation.">sparta::GlobalOrderingPoint</a></li>
<li>Between an event and port, use methods like <a class="el" href="classsparta_1_1InPort.html#a1a7e27e872e1e73ce02aa320a0973346" title="Add an event &quot;listener&quot; to this port.">sparta::InPort::registerConsumerEvent</a> and <a class="el" href="classsparta_1_1OutPort.html#a6a9af2af9223255b8b1fc4877e5893d5" title="Add an event &quot;producer&quot; to this port.">sparta::OutPort::registerProducingEvent</a></li>
<li>Place an event on an earlier (or later) <a class="el" href="namespacesparta.html#aeec80d237ace9f07634c3d24c9aed9a0" title="The SchedulingPhases used for events (Tick, Update, PortUpdate, etc)">sparta::SchedulingPhase</a></li>
</ol>
<h3><a class="anchor" id="autotoc_md14"></a>
Dumping Out Scheduler Information</h3>
<p>To determine which event is scheduling another event, the <a class="el" href="classsparta_1_1Scheduler.html" title="A class that lets you schedule events now and in the future.">sparta::Scheduler</a> has an internal debugging logger (called <code>debug</code>) to help. To invoke the logger, use the the</p>
<div class="fragment"><div class="line">-l [ --log ] PATTERN CATEGORY DEST</div>
</div><!-- fragment --><p>command line option if the model uses <a class="el" href="classsparta_1_1app_1_1CommandLineSimulator.html" title="Command line simulator front-end class with argument parsing Works in conjunction with sparta::app::S...">sparta::app::CommandLineSimulator</a> class:</p>
<div class="fragment"><div class="line">./sparta_core_example -l scheduler debug 1 | less -R</div>
</div><!-- fragment --><p>The above example will dump the <a class="el" href="classsparta_1_1Scheduler.html" title="A class that lets you schedule events now and in the future.">sparta::Scheduler</a> debug logger to stdout which is fed through a pipe to the <code>less</code> command with escape sequences displayed (<code>-R</code>). Using <code>less</code>, search for the named event of interest. For example, taking the output from the sparta_core_example, search for <code>dispatchInstructions_</code> to see which event caused it to be triggered:</p>
<div class="fragment"><div class="line">{0000000000 -------- scheduler debug} --&gt; SCHEDULER: Firing retire_insts[ROB::retireEvent_()] at time: 10000 group: 12</div>
<div class="line">{0000000000 -------- scheduler debug} scheduling: dispatch_event[Dispatch::dispatchInstructions_()] at tick: 10000 rel_time: 0 group: 14 continuing: <span class="keyword">true</span></div>
</div><!-- fragment --><p>From the lines above, the modeler can see the event <code>dispatchInstructions_</code> was scheduled when the event <code>retireEvent_</code> was fired.</p>
<p>Remember that logging and the command line flag</p>
<div class="fragment"><div class="line">--debug-on [CLOCK] CYCLE</div>
</div><!-- fragment --><p>can be used together to <em>only</em> dump a log starting at the given cycle. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Aug 22 2025 17:16:11 for The Sparta Modeling Framework by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
