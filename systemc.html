<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The Sparta Modeling Framework: SystemC Models</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">The Sparta Modeling Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('systemc.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">SystemC Models</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Sparta Scheduler can work in a SystemC environment using the <a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html" title="Class that &quot;connects&quot; Sparta to SystemC.">sparta::SysCSpartaSchedulerAdapter</a>.</p>
<h1><a class="anchor" id="building_sysc"></a>
Building</h1>
<p>To enable SystemC in Sparta, the cmake option COMPILE_WITH_SYSTEMC must be ON. To run SystemC tests and the TLM examples, make sure Sparta's CMake build environment can find the SystemC package during configuration. A message in the configuration output will be written if the package was found and COMPILE_WITH_SYSTEMC with set to ON:</p>
<div class="fragment"><div class="line">% cd <a class="code hl_namespace" href="namespacesparta.html">sparta</a>/build; cmake .. -DCMAKE_BUILD_TYPE=Release -DCOMPILE_WITH_SYSTEMC=ON</div>
<div class="line">...</div>
<div class="line">-- SystemC enabled: 2.3.3.20181013</div>
<div class="line">...</div>
<div class="ttc" id="anamespacesparta_html"><div class="ttname"><a href="namespacesparta.html">sparta</a></div><div class="ttdoc">Macros for handling exponential backoff.</div><div class="ttdef"><b>Definition</b> <a href="AppTriggers_8hpp_source.html#l00022">AppTriggers.hpp:22</a></div></div>
</div><!-- fragment --><p>If not, then <code>cmake</code> could not find the SystemC package. This can happen if there exists an install of SystemC elsewhere on the system (like a user's home directory). Sparta can still use that install, but it must be built with the same C++ standard as Sparta (C++17 for example). First, build SystemC:</p>
<div class="fragment"><div class="line">cd /path/to/systemc-2.3.x; mkdir build; cd build</div>
<div class="line">cmake .. -DCMAKE_CXX_STANDARD=17 -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">make install</div>
</div><!-- fragment --><p>Then, configure/build Sparta again:</p>
<ol type="1">
<li>Set your <code>SYSTEMC_HOME</code> environment variable to the SystemC build: <code>export SYSTEMC_HOME=/path/to/systemc-2.3.x</code></li>
<li>Re-configure Sparta: <code>cmake .. -DCMAKE_BUILD_TYPE=Release -DCOMPILE_WITH_SYSTEMC=ON</code></li>
</ol>
<p>The enablement message should print at this point.</p>
<p>To build/run the SystemC example (example/SystemC), the TLM <code>example</code> directory must be found. Since the TLM examples are not part of an install, the Sparta SystemC example CMakeLists.txt file will use the environment variable SYSTEMC_HOME to locate it.</p>
<h1><a class="anchor" id="sysc_adapter"></a>
SystemC/Sparta Adapter</h1>
<p>The <a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html" title="Class that &quot;connects&quot; Sparta to SystemC.">sparta::SysCSpartaSchedulerAdapter</a> is just that, an adapter that syncs the SystemC clock with the Sparta Scheduler. With this class, the modeler is not responsible for advancing time on the Sparta scheduler. SystemC will be doing that via SC_THREADs.</p>
<p>However, Sparta assumes "control" of the scheduling in that the adapter by starting the SystemC scheduler (<code>sc_core::sc_start</code>) via the <a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html#a972ac4ded0ecfff5c34aa96a3381a1ce" title="Run simulation â€“ all of it including SystemC.">sparta::SysCSpartaSchedulerAdapter::run</a> method.</p>
<p>The expected development using this adapter is:</p>
<ol type="1">
<li>Implement <code>sc_main</code> as normal</li>
<li>Instantiate Sparta components including a <a class="el" href="classsparta_1_1Scheduler.html" title="A class that lets you schedule events now and in the future.">sparta::Scheduler</a>, <a class="el" href="classsparta_1_1ResourceTreeNode.html" title="TreeNode subclass representing a node in the device tree which contains a single ResourceFactory and ...">sparta::ResourceTreeNode</a>, etc</li>
<li>Instantiate the <a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html" title="Class that &quot;connects&quot; Sparta to SystemC.">sparta::SysCSpartaSchedulerAdapter</a> passing to its constructor the <a class="el" href="classsparta_1_1Scheduler.html" title="A class that lets you schedule events now and in the future.">sparta::Scheduler</a> created</li>
<li>Call <code>run()</code> on the adapter</li>
</ol>
<p>See an example of this in <code>sparta/test/SystemC_test.cpp</code>.</p>
<h1><a class="anchor" id="sysc_examples"></a>
SystemC/Sparta Examples</h1>
<p>There are 3 other examples of how Sparta can be used in a SystemC environment in the examples/SystemC directory. These examples use the TLM examples found in the SystemC distribution (<code>systemc/examples/tlm</code>). Make sure <code>-DTLM_EXAMPLES_DIR=/path/to/systemc/examples/tlm</code> is set before running <code>cmake</code> on Sparta to enabled these examples.</p>
<div class="fragment"><div class="line">1_phase</div>
<div class="line">2_phase</div>
<div class="line">4_phase</div>
</div><!-- fragment --><p>Each directory is an example of using the TLM initiator/target at_*_phase example swapping out the TLM target with a Sparta memory object and a Sparta/TLM socket adapter.</p>
<p>Each example illustrates a TLM/SystemC transaction initiator (traffic generator) found in <code>systemc/examples/tlm/at_?_phase/include/initiator_top.h</code> connected to a TLM/SystemC <code>SimpleBusAT</code> found in <code>systemc/examples/tlm/common/include/models/SimpleBusAT.h</code> driving requests into a Sparta <code><a class="el" href="classsparta__target_1_1SpartaMemory.html">sparta_target::SpartaMemory</a></code> object.</p>
<p>Transactions from the initiators flow throw the bus and into SystemC/TLM/Sparta Gasket <code><a class="el" href="classsparta__target_1_1SpartaTLMTargetGasket.html">sparta_target::SpartaTLMTargetGasket</a></code>.</p>
<p>The gaskets "convert" <code>tlm_generic_payload</code> objects into a <code><a class="el" href="structsparta__target_1_1MemoryRequest.html">sparta_target::MemoryRequest</a></code> on a <code>nb_transport_fw</code> which in turn is fed into the the <code><a class="el" href="classsparta__target_1_1SpartaMemory.html">sparta_target::SpartaMemory</a></code> object.</p>
<p>Responses are converted back from the Sparta data types to the TLM payload.</p>
<p>Here's a simple diagram of the flow:</p>
<div class="dotgraph">
<img src="dot_inline_dotgraph_5.png" alt="dot_inline_dotgraph_5.png" border="0" usemap="#dot_inline_dotgraph_5.map"/>
<map name="dot_inline_dotgraph_5.map" id="dot_inline_dotgraph_5.map"><area shape="rect" href="SpartaTLMTargetGasket_8hpp_source.html" title="\N" alt="" coords="715,5,880,55"/>
<area shape="rect" href="SpartaMemory_8hpp_source.html" title="\N" alt="" coords="1150,5,1256,55"/>
<area shape="poly" href="MemoryRequest_8hpp_source.html" title="sparta_target::MemoryRequest" alt="" coords="881,27,1135,27,1135,33,881,33"/>
<area shape="rect" href="MemoryRequest_8hpp_source.html" title="sparta_target::MemoryRequest" alt="" coords="904,9,1126,30"/>
</map>
</div>
<p>Simulation instantiation occurs in the typical <code><a class="el" href="sc__main_8cpp_source.html">sc_main.cpp</a></code> found in <code>sparta/example/SystemC/common</code>. The main class that creates the simulator is <code><a class="el" href="classsparta__sim_1_1SpartaSystemCSimulator.html" title="Top level constructor for the SystemC example TLM simulator.">sparta_sim::SpartaSystemCSimulator</a></code> found in the same directory.</p>
<p>This class creates the following components:</p>
<ul>
<li><code><a class="el" href="classsystemc__example_1_1systemc__example__top.html">systemc_example::systemc_example_top</a></code> that contains the <code>tlm::SimpleBusAT</code> and the two <code>tlm::initiator_top</code> instances</li>
<li><code><a class="el" href="classsparta__target_1_1SpartaTLMTargetGasket.html">sparta_target::SpartaTLMTargetGasket</a></code> that binds to SystemC on one side and Sparta on the other</li>
<li><code><a class="el" href="classsparta__target_1_1SpartaMemory.html">sparta_target::SpartaMemory</a></code> which is the receiver of traffic from the initiators</li>
<li><code><a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html" title="Class that &quot;connects&quot; Sparta to SystemC.">sparta::SysCSpartaSchedulerAdapter</a></code> which will run the simulator including the SystemC kernel</li>
</ul>
<p>Binding of the classes occurs in <code><a class="el" href="classsparta__sim_1_1SpartaSystemCSimulator.html" title="Top level constructor for the SystemC example TLM simulator.">sparta_sim::SpartaSystemCSimulator</a></code>.</p>
<p>Finally, this class, when told to run, will run the <code><a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html" title="Class that &quot;connects&quot; Sparta to SystemC.">sparta::SysCSpartaSchedulerAdapter</a></code> which runs both sparta and the SystemC components</p>
<p>Caveats on using the SystemC adapters:</p>
<ol type="1">
<li>Only one adapter is allowed in simulation</li>
<li>Only one <a class="el" href="classsparta_1_1Scheduler.html" title="A class that lets you schedule events now and in the future.">sparta::Scheduler</a> is allowed in simulation</li>
<li>Time advancement bounces between SystemC and Sparta. Zero-timed communication between a SysC component and a Sparta component may not work if the Sparta component requires advancement from the Sparta Scheduler. This is currently untested.</li>
<li>Communication between a Sparta component (Sparta Port) and a SystemC Port (or TLM callback) requires a Sparta/SystemC gasket to be written by the modeler </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Feb 9 2026 03:27:54 for The Sparta Modeling Framework by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
